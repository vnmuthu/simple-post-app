(this["webpackJsonpsimple-post-app"]=this["webpackJsonpsimple-post-app"]||[]).push([[0],{32:function(e,t,a){e.exports=a(63)},37:function(e,t,a){},38:function(e,t,a){},56:function(e,t,a){},57:function(e,t,a){},63:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),s=a(28),i=a.n(s),c=a(29),o=a(1),l=(a(37),a(7)),u=a(8),d=a(9),m=a(14),h=a(13),p=(a(38),a(12)),f=a.n(p),b=new(function(){function e(){Object(l.a)(this,e)}return Object(u.a)(e,[{key:"doRegistration",value:function(e,t){return f.a.post("https://api.supermetrics.com/assignment/register",{client_id:"ju16a6m81mhid5ue1z3v2g0uh",email:t,name:e}).then((function(e){return(e.data&&e.data.data).sl_token})).catch((function(e){console.log(e)}))}}]),e}()),v=function(e){Object(m.a)(a,e);var t=Object(h.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).userNameHandler=function(e){n.setState({userName:e.target.value})},n.userEmailHandler=function(e){n.setState({userEmail:e.target.value})},n.state={isLoggedIn:!1,tokenId:"",userName:"",userEmail:""},n.handleOnSubmit=n.handleOnSubmit.bind(Object(d.a)(n)),n}return Object(u.a)(a,[{key:"handleOnSubmit",value:function(e){var t=this;e.preventDefault(),this.state.userName&&this.state.userEmail?b.doRegistration(this.state.userName,this.state.userEmail).then((function(e){t.setState({tokenId:e,isLoggedIn:!0}),t.props.history.push({pathname:"/posts",state:{isLoggedIn:t.state.isLoggedIn,tokenId:t.state.tokenId}})})).catch((function(e){console.log(e)})):alert("Please Enter Name and Email")}},{key:"render",value:function(){return r.a.createElement("div",{className:"login"},r.a.createElement("form",{onSubmit:this.handleOnSubmit},r.a.createElement("h2",null,r.a.createElement("span",null,"SM"),"SuperMail"),r.a.createElement("div",{className:"name"},r.a.createElement("div",{className:"name-label"},"Name"),r.a.createElement("input",{type:"text",name:"username",onChange:this.userNameHandler})),r.a.createElement("div",{className:"email"},r.a.createElement("div",{className:"email-label"},"Email"),r.a.createElement("input",{type:"text",name:"useremail",onChange:this.userEmailHandler})),r.a.createElement("input",{type:"submit",className:"submit-btn",value:"GO"})))}}]),a}(r.a.Component),S=a(31),g=(a(56),new(function(){function e(){Object(l.a)(this,e)}return Object(u.a)(e,[{key:"fetchPosts",value:function(e){var t="https://api.supermetrics.com/assignment/posts?sl_token="+e;return f.a.get(t).then((function(e){return e&&e.data&&e.data.data})).catch((function(e){console.log(e)}))}}]),e}()));function E(e){return e.activeSender===e.dataTab?r.a.createElement("li",{onClick:e.onClick,className:"tab-title active-tab","data-tab":e.dataTab},e.title," ",r.a.createElement("span",{className:"totalPostCount"},e.dataCount)):r.a.createElement("li",{onClick:e.onClick,className:"tab-title","data-tab":e.dataTab},e.title," ",r.a.createElement("span",{className:"totalPostCount"},e.dataCount))}function y(e){return r.a.createElement("div",{className:"post-items",style:e.style,"data-tab":e.dataTab},r.a.createElement("div",{className:"post-items-head"},r.a.createElement("span",{onClick:e.onClick,className:"sort-icon"},"\u2191\u2193"),r.a.createElement("h1",null,e.dataTabSender)),r.a.createElement("ul",null,e.content.map((function(e,t){return r.a.createElement("li",{key:e.id},r.a.createElement("div",{className:"post-time"},function(e){var t=new Date(e),a=t.toLocaleString("default",{month:"long"}),n="".concat(t.getDate()).padStart(2,"0"),r=t.getFullYear(),s="".concat(t.getHours()).padStart(2,"0")+":"+"".concat(t.getMinutes()).padStart(2,"0")+":"+t.getSeconds();return"".concat(a," ").concat(n,", ").concat(r," ").concat(s)}(e.created_time)),r.a.createElement("div",{className:"post-message"},e.message))}))))}var k=function(e){Object(m.a)(a,e);var t=Object(h.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).state={senderPostData:[],isPostsAvailable:!1,activeSender:"",sortOrder:"asc",searchSenderString:""},n.changeActiveSender=n.changeActiveSender.bind(Object(d.a)(n)),n.sortPostsByDate=n.sortPostsByDate.bind(Object(d.a)(n)),n.handleSenderSearch=n.handleSenderSearch.bind(Object(d.a)(n)),n}return Object(u.a)(a,[{key:"render",value:function(){var e=this,t=this.state.senderPostData,a=this.state.searchSenderString.trim().toLowerCase();a.length>0&&(t=this.findSender(a));var n=t.map((function(t){return r.a.createElement(E,{key:t.id,activeSender:e.state.activeSender,onClick:e.changeActiveSender,dataTab:t.id,title:t.tabTitle,dataCount:t.tabPostCount})})),s=t.map((function(t){return e.state.activeSender===t.id?r.a.createElement(y,{key:t.id,onClick:e.sortPostsByDate,dataTab:t.id,dataTabSender:t.tabTitle,content:t.tabContent}):r.a.createElement(y,{key:t.id,style:{display:"none"},dataTabSender:t.tabTitle,dataTab:t.id,content:t.tabContent})}));return r.a.createElement("div",{className:"posts"},r.a.createElement("ul",{className:"sender-title"},r.a.createElement("li",{className:"sender-head"},r.a.createElement("span",null,"SM")," SuperMail"),r.a.createElement("li",{className:"sender-search"},r.a.createElement("input",{type:"text",name:"search-sender",placeholder:"Search Sender",ref:"searchSender",onKeyUp:this.handleSenderSearch})),n),r.a.createElement("div",{className:"post-content"},s))}},{key:"componentDidMount",value:function(){var e=this;"undefined"!==typeof this.props.location.state&&0===this.state.senderPostData.length?g.fetchPosts(this.props.location.state.tokenId).then((function(t){var a=t.posts,n=e.groupPostsBySenderTitle(a);e.setState({isPostsAvailable:!0,senderPostData:n,activeSender:n.slice(0,1).shift().id}),e.refs.searchSender.focus()})).catch((function(t){console.log(t),e.props.history.push("/login")})):(console.log("Login session expired. Please login again!"),this.props.history.push("/login"))}},{key:"groupPostsBySenderTitle",value:function(e){var t={},a=e.reduce((function(e,t){var a=t.from_name;return e[a]=e[a]||[],e[a].push(t),e}),{});return Object.keys(a).sort().forEach((function(e){t[e]=a[e]})),this.transformSenderData(t)}},{key:"transformSenderData",value:function(e){var t=[];if(e)for(var a=function(){var e,a=Object(S.a)(r[n],2)[1],s=a.map((function(e){return e.from_name})),i=s.filter((function(e,t){return s.indexOf(e)===t})),c=a.map((function(e){return e.from_id}));e={id:c.filter((function(e,t){return c.indexOf(e)===t})).toString(),tabTitle:i.toString(),tabContent:a,tabPostCount:a.length},t.push(e)},n=0,r=Object.entries(e);n<r.length;n++)a();return t}},{key:"changeActiveSender",value:function(e){this.setState({activeSender:e.target.getAttribute("data-tab")})}},{key:"sortPostsByDate",value:function(){var e="asc",t=this.state,a=t.activeSender,n=t.senderPostData,r=t.sortOrder;n.filter((function(e){return e.id===a})).map((function(t){return"asc"===r?(e="desc",t.tabContent.sort((function(e,t){return new Date(e.created_time)-new Date(t.created_time)}))):t.tabContent.sort((function(e,t){return new Date(t.created_time)-new Date(e.created_time)}))})),this.setState({senderPostData:n,sortOrder:e})}},{key:"handleSenderSearch",value:function(){this.setState({searchSenderString:this.refs.searchSender.value})}},{key:"findSender",value:function(e){var t=this.state.senderPostData;return e?t.filter((function(t){return t.tabTitle.toLowerCase().match(e)})):t}}]),a}(r.a.Component),N=(a(57),function(){return r.a.createElement("h1",null,"Sorry, The requested page is not found")}),O=r.a.createElement(c.a,null,r.a.createElement("div",{className:"postApp"},r.a.createElement(o.c,null,r.a.createElement(o.a,{exact:!0,path:"/",component:v}),r.a.createElement(o.a,{path:"/login",component:v}),r.a.createElement(o.a,{path:"/posts",component:k}),r.a.createElement(o.a,{path:"/posts/:id",component:k}),r.a.createElement(o.a,{component:N}))));i.a.render(O,document.getElementById("root"))}},[[32,1,2]]]);
//# sourceMappingURL=main.6bd36be0.chunk.js.map